<h1>도커의 동작원리</h1>

- 도커와 컨테이너
- 도커가 물리서버 안에 자리잡는 형태
- 컨테이너가 만들어지는 원리
- 사고방식, 요령


1. 도커의 동작 원리
   > 도커는 리눅스 용이다.
   따라서 도커를 실행하기 위해서는 리눅스가 필요하고, 컨테이너 별로 리눅스 주변부를 가지고 있다

    - 도커의 구조
      > 컨테이너 안에 '커널 주변부분' <sup>리눅스 운영체제 비스무리한거</sup> 을 가지고 있다  
      주변부분이 컨테이너 안의 프로그램들의 명령을 받아 서버의 커널에 보낸다

    - 도커는 기본적으로 '리눅스용'이다
      > 도커는 리눅스 운영체제에서 동작하는 걸 전제로, 리눅스 주변부분을 컨테이너별로 가지고 있음    
      **컨테이너에 들어가는 소프트웨어은 리눅스용이어야함**  
      윈도우/mac도 리눅스 운영체제가 있어야 도커가 동작  
      물리서버 운영체제와 도커 운영체제를 통일할 필요는 없음  
      **그러나, 프로그램과 도커 운영체제의 호환성은 체크해볼 것 <sup>DBMS</sup>**


2. 도커 허브와 이미지, 그리고 컨테이너
   > 허브에서 이미 만들어진 이미지들을 받아서 컨테이너 구축

    - 이미지와 컨테이너
      > 이미지 : 컨테이너의 설계도, 빵틀    
      이미지를 기반으로 만든 컨테이너를 개조함 -> 기반으로 다시 이미지 만들 수 있음  
      '개조한 이미지'를 기반으로 여러 서버에 컨테이너 구축 시 활용  
      이미지 export하여 다른 도커엔진에 컨테이너 구축

    - 도커 허브와 도커 이미지
      > **원칙 : 한 컨테이너에는 하나의 프로그램만 설치한다** <sup>보안, 유지/보수 유리</sup>  
      1 컨테이너 n 프로그램 : 바로 실행 가능하여 자주 쓰임
      허브에서 배포된 여러 이미지들을 활용  
      ex. centOS, Ubuntu + apache, CentOS7.6 + apache + mysql, ....
      > - 공식 이미지를 사용 : 이미지 선택이 쉽고, 안전
      > - 커스텀 이미지를 사용 : 이미지를 직접 만들어서 사용

3. 도커 컨테이너의 생애주기와 데이터 저장
   > 컨테이너는 쓰고 버리면 되고, 그 안의 데이터는 물리 서버에 마운트하여 보존된다

    - 도커 컨테이너는 '쓰고 버리는' 일회용품
      > **컨테이너 생애주기** : 업데이트가 필요하면 새로운 컨테이너로 갈아탄다.  
      컨테이너 내용을 업데이트 하지말고, 업데이트된 이미지로 된 컨테이너를 구축

    - 데이터 저장
      > 컨테이너에서 생성되는 데이터는 물리 서버에 마운트하여 컨테이너 외부에 저장
      >  - 컨테이너 교체시 데이터 보존
      >  - 도커에 문제가 생겨도 데이터 보존
      >  - 다른 컨테이너와 데이터 공유 가능
      
4. 도커의 장점과 단점
   > 컨테이너로서 서로 격리되기 때문에, 서버 유지보수, 구현이 쉬움
     컨테이너가 하나만 필요하면 도커가 오버헤드

    - 도커의 구조와 성질 및 그 장단점
      > - 독립된 환경 : 다수의 컨테이너로 같은 애플리케이션도 여러개 띄울 수 있음
      > - 이미지 : 이미지를 허브에서 편하게 내려받아 컨테이너 구축, 업데이트 가능하고, 이동성도 좋음
      > - 커널이 없어 가벼움 : 도커에는 커널이 없고, 커널 주변부분만 있어 가볍고 빠름
    
    - 도커의 장점과 단점
      > - 장점
      >   -  1 물리 서버 n 기능 서버 : 컨테이너가 서로 격리되어 안전하게 기능 구현
      >   -  서버 관리가 쉬움 : 최신 버전의 컨테이너 유지, 소프트웨어 간의 경합 없음  
      > - 단점
      >   -  컨테이너에는 리눅스용 소프트웨어만 가능
      >   - 호스트 서버에 문제가 생기면 모든 컨테이너에 전파
      >   - 컨테이너의 생명주기가 길다면 장점이 높지 않음  
      >   - 컨테이너가 하나라면 도커엔진은 오버헤드에 지나지 않음
    - 도커의 주 용도
      > - 동일한 개발환경 제공 : 운영환경의 컨테이너를 개발환경에서도 사용함
      > - 운영환경 릴리즈 배포 리스크 감소 : 개발환경과 동일한 컨테이너이므로
      > - 동일서버가 여러대 필요한 경우 : 1 물리서버에 여러개의 컨테이너 생성
   
